const SitesJS={requestAPI:(t,e,r)=>{let s=5;!function n(){return new Promise(((a,o)=>{let i=0,c=setTimeout((()=>{0===i&&(i=2,c=null,o("请求超时"),0==s&&r())}),5e3);fetch(t).then((function(t){if(2!==i&&(clearTimeout(c),a(t),c=null,i=1),t.ok)return t.json();throw new Error("Network response was not ok.")})).then((function(t){s=0,e(t)})).catch((function(t){s>0?(s-=1,setTimeout((()=>{n()}),5e3)):r()}))}))}()},layout:t=>{const e=t.el;SitesJS.requestAPI(t.api,(function(r){e.querySelector(".loading-wrap").remove();const s=r.content;var n="";s.forEach(((e,r)=>{var s='<div class="site-card">';s+='<a class="card-link" target="_blank" rel="external noopener noreferrer" href="'+e.url+'">',s+='<img alt="'+e.title+'" src="'+(e.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+e.url)+'" onerror="javascript:this.onerror=null;this.src=\''+t.screenshot+"';\"/>",s+='<div class="info">',s+='<img alt="'+e.title+'" src="'+(e.avatar||t.avatar)+'" onerror="javascript:this.onerror=null;this.src=\''+t.avatar+"';\"/>",s+='<span class="title">'+e.title+"</span>",s+='<span class="desc">'+(e.description||e.url)+"</span>",s+="</div>",s+="</a>",n+=s+="</div>"})),e.querySelector(".group-body").innerHTML=n}),(function(){try{e.querySelector(".loading-wrap svg").remove(),e.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(t){}}))},start:t=>{const e=document.getElementsByClassName("sitesjs-wrap");for(var r=0;r<e.length;r++){const s=e[r],n=s.getAttribute("api");if(null!=n)(t=new Object).class=s.getAttribute("class"),t.el=s,t.api=n,t.avatar=volantis.THEMECONFIG.source.githubApi.sites,t.screenshot=volantis.THEMECONFIG.source.githubApi.screenshot,SitesJS.layout(t)}}};SitesJS.start(),document.addEventListener("pjax:complete",(function(){SitesJS.start()}));